:root {
  --bg: #0e0f13;
  --fg: #e9edf1;
  --accent: #4da3ff;
  --muted: #9aa4af;
  --card: #141824;
  --line: #2a2f3a;
  --font: system-ui, Segoe UI, Roboto, Arial, sans-serif;
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  background: var(--bg);
  color: var(--fg);
  font-family: var(--font);
}

.topbar {
  display: flex; align-items: center; justify-content: space-between;
  gap: 8px; padding: 8px 12px; position: sticky; top: 0; z-index: 20;
  background: rgba(20,24,36,0.8); backdrop-filter: blur(8px);
  border-bottom: 1px solid var(--line);
}
.topbar .left, .topbar .right { display: flex; align-items: center; gap: 8px; }
.topbar .center { opacity: .9; }
button, .toggle { background: var(--card); color: var(--fg); border: 1px solid var(--line); padding: 6px 10px; border-radius: 6px; cursor: pointer; }
button:hover { border-color: var(--accent); }
input[type="checkbox"] { vertical-align: middle; }

#drop-hint {
  display: none; text-align: center; padding: 10px; color: var(--muted);
}

.stage {
  display: grid; place-items: center; height: calc(100vh - 56px);
  padding: 10px; overflow: hidden;
}
.slides { position: relative; width: 100%; height: 100%; display: grid; place-items: center; }
.slide {
  position: absolute; inset: 0; margin: auto; width: calc(min(100vw - 20px, (100vh - 80px) * 16/9));
  aspect-ratio: 16 / 9; background: var(--card); border: 1px solid var(--line); border-radius: 12px;
  padding: 40px; overflow: hidden; display: none;
}
.slide.active { display: block; }
.slide .title { font-size: clamp(28px, 6.5vw, 64px); margin: 0 0 12px; }
.slide .subtitle { font-size: clamp(18px, 3vw, 28px); color: var(--muted); margin: 0 0 16px; }
.slide .content p, .slide .content li { font-size: clamp(16px, 2vw, 24px); line-height: 1.35; }
.slide .footer { position: absolute; left: 40px; right: 40px; bottom: 20px; color: var(--muted); display: flex; justify-content: space-between; align-items: center; }
.media img, .media video { width: 100%; height: 100%; object-fit: contain; border-radius: 8px; }
.media video[controls] { position: relative; z-index: 2; }
.slide.video-controls .media video[controls] { height: calc(100% - 48px); }
.media.cover img, .media.cover video { object-fit: cover; }
.media { width: 100%; height: 100%; }
.embed { width: 100%; height: 100%; }
.embed iframe { width: 100%; height: 100%; border: none; background: #0b0e15; border-radius: 8px; }
.slide.fullbleed { padding: 0; }
.slide.fullbleed .footer { display: none; }
.slide.fullbleed .title, .slide.fullbleed .subtitle { display: none; }
.pan-container { position: relative; overflow: hidden; width: 100%; height: 100%; cursor: grab; }
.pan-container.grabbing { cursor: grabbing; }
.pan-container .pan-content { position: absolute; top: 50%; left: 50%; transform: translate(calc(-50% + var(--pan-x, 0px)), calc(-50% + var(--pan-y, 0px))); will-change: transform; }

/* Mindmap (нативний, без iframe) */
.mindmap { width: 100%; height: 100%; background: transparent; }
.mindmap .mm-svg { width: 100%; height: 100%; display: block; }

.progress { position: fixed; left: 0; right: 0; bottom: 0; height: 6px; background: rgba(255,255,255,0.05); z-index: 25; pointer-events: none; }
#progress-bar { height: 100%; width: 0; background: linear-gradient(90deg, var(--accent), #7bc2ff); transition: width .2s ease; }

.notes { position: fixed; left: 10px; bottom: 12px; max-width: 30vw; background: rgba(20,24,36,0.9); border: 1px solid var(--line); border-radius: 8px; padding: 8px 10px; color: var(--muted); z-index: 22; display: none; }
.notes.visible { display: block; }

.slide.video-controls .footer { display: none; }

.overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 30; display: grid; place-items: center; }
.overlay.hidden { display: none; }
.overlay .overlay-content { background: var(--card); border: 1px solid var(--line); border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,.35); max-width: min(96vw, 1200px); max-height: 90vh; overflow: auto; padding: 16px; }
.overlay .overlay-close { position: absolute; top: 10px; right: 10px; padding: 6px 10px; }
.help ul { columns: 2; gap: 24px; }

.grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 12px; }
.grid .thumb { background: var(--card); border: 1px solid var(--line); border-radius: 10px; overflow: hidden; cursor: pointer; }
.grid .thumb .mini { aspect-ratio: 16/9; background: #111; display: grid; place-items: center; color: var(--muted); }
.grid .thumb h4 { margin: 8px 10px 10px; font-size: 14px; color: var(--fg); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.grid .thumb p { margin: 0 10px 12px; color: var(--muted); font-size: 12px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

.modal { width: min(96vw, 1100px); }
.modal-header { display: flex; align-items: center; gap: 8px; }
.modal-header .spacer { flex: 1; }
.modal-body.split { display: grid; grid-template-columns: 320px 1fr; gap: 12px; }
.list { list-style: none; padding: 0; margin: 0; }
.list li { padding: 8px 10px; border-bottom: 1px solid var(--line); cursor: pointer; }
.list li.active { background: rgba(77,163,255,0.12); }
.form label { display: grid; gap: 6px; margin-bottom: 10px; }
.form input, .form textarea { width: 100%; background: #0d1018; border: 1px solid var(--line); color: var(--fg); padding: 8px; border-radius: 6px; }
.form .row { display: flex; gap: 8px; }
.preview { margin-top: 12px; }

.blackout { position: fixed; inset: 0; background: #000; z-index: 40; }
.hidden { display: none !important; }

/* Друк у PDF: кожен слайд на окремій сторінці */
@media print {
  body { background: #fff; color: #000; }
  .topbar, .progress, .notes, .overlay, #drop-hint { display: none !important; }
  .stage { height: auto; }
  .slides { display: block; }
  .slide { position: static; display: block; page-break-after: always; border: none; width: 100%; aspect-ratio: auto; }
}
